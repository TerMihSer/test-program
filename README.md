# test-program
Тестовая программа

Тестовое:
Нужно сделать рекурсивную цепочку комментариев с сохранением в БД.
 
Изначально должна быть форма отправки комментария, ниже неё выводится список отправленных. На каждый комментарий можно дать ответ, и так до бесконечности.
 
Верстка не важна, достаточно textarea для ввода текста и кнопки отправления, список комментариев ниже выводится в древовидном виде. Под каждым комментарием кнопка ответить, которая открывает textarea и кнопку отправления.
 
Обновление комментариев после добавления должно происходить средствами ajax.


Использование модуля  
modules/messages  
Алгоритм работы:  
Форма на главной странице работает как с использованием javascript так и без, но без js фунционал упрощен по причине невозможности загрузить форму для отправки сообщения по ajax.
При отправке формы отправляется два значения parent_id скрытое поле и само сообщение. Форму обрабатывает модуль messages actionSaveMessage, этот метод сохраняет сообщение и возвращает сохраненное сообщение на front для отображения его в дереве сообщений.
При нажатии на ссылку "Ответить" запрос уходит модулю actionGetForm, он возвращает форму, после чего она отображается на front и пользователь может оставить новое сообщение. При повторном нажатии на "ответить", отображается уже та форма, что была сохранена на фронте.  
modules/messages/models/Messages.php - бизнес логика  
modules/messages/models/MessagesForm.php - форма  
modules/messages/models/MessagesFormat.php - модель форматирования, строит дерево из комментариев  
modules/messages/models/MessagesRepository.php - работает с базой данных.  
Html дерево строится в виджете модуля modules/messages/widgets/Messages.php